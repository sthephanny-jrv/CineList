<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="movies:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22currentColor%22%20class%3D%22bi%20bi-camera-reels-fill%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M6%203a3%203%200%201%201-6%200%203%203%200%200%201%206%200%22%2F%3E%3Cpath%20d%3D%22M9%206a3%203%200%201%201%200-6%203%203%200%200%201%200%206%22%2F%3E%3Cpath%20d%3D%22M9%206h.5a2%202%200%200%201%201.983%201.738l3.11-1.382A1%201%200%200%201%2016%207.269v7.462a1%201%200%200%201-1.406.913l-3.111-1.382A2%202%200%200%201%209.5%2016H2a2%202%200%200%201-2-2V8a2%202%200%200%201%202-2z%22%2F%3E%3C%2Fsvg%3E" type="image/svg+xml">
    <title>CineList</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>

    <header>
        <h1>CineList</h1>
    </header>

    <nav class="navigation-bar">
        <a href="#" onclick="popular()">Populares</a>
        <a href="#" onclick="now_playing()">Em Exibição</a>
        <a href="#" onclick="top_rated()">Mais Votados</a>
        <a href="#" onclick="favorites()"><strong>☆</strong> Favoritos</a>
    </nav>

    <div id="id-popular" class="popular"></div>
    <div id="id-now_playing" class="now_playing"></div>
    <div id="id-top_rated" class="top_rated"></div>
    <div id="id-favorites" class="favorites"></div>

    <script>
        async function popular() {
            toggleSections('id-popular');
            
            try {
                const response = await fetch('http://localhost:3000/cinelist/movies/popular?page=1');
                const movies = await response.json();
                renderMovies(movies, 'id-popular');
            } catch (error) {
                console.error('Erro ao buscar filmes populares:', error);
            }
        }
        


        async function now_playing() {
            toggleSections('id-now_playing');

            try {
                const response = await fetch('http://localhost:3000/cinelist/movies/now_playing?page=1');
                const movies = await response.json();
                renderMovies(movies, 'id-now_playing');
            } catch (error) {
                console.error('Erro ao buscar filmes em exibição:', error);
            } 
        }



        async function top_rated() {
            toggleSections('id-top_rated');

            try {
                const response = await fetch('http://localhost:3000/cinelist/movies/top_rated?page=1');
                const movies = await response.json();
                renderMovies(movies, 'id-top_rated');
            } catch (error) {
                console.error('Erro ao buscar filmes mais votados:', error);
            }
        }



        function favorites() {
            toggleSections('id-favorites');
            const container = document.getElementById('id-favorites');
            container.innerHTML = '<p>Favoritos em breve...</p>';
        }

        
        function toggleSections(sectionId) {
            const sections = ['id-popular', 'id-now_playing', 'id-top_rated', 'id-favorites'];
            sections.forEach(id => {
                document.getElementById(id).style.display = id === sectionId ? 'block' : 'none';
            });
        }

        // Função para renderizar os filmes na tela
        function renderMovies(movies, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';

            movies.forEach(movie => {
                const movieItem = document.createElement('div');
                movieItem.classList.add('movie-item');
                movieItem.innerHTML = `
                    <h3 id="title">${movie.title}</h3>
                    <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" alt="${movie.title}">
                    <button onclick="showMoreDetails(this)">Ver mais</button>
                    <p class="movie-details">
                        <strong>Overview: </strong> ${movie.overview}<br>
                        <br>
                        <strong>Data de Lançamento: </strong> ${movie.release_date}<br>
                        <br>
                        <strong>Nota: </strong> ${movie.vote_average}<br>
                        <br>
                        <strong>Contagem de Votos: </strong> ${movie.vote_count}
                    </p>
                `;
                container.appendChild(movieItem);
            });
        }

        // Função para exibir mais informações sobre o filme
        function showMoreDetails(button) {
            const movieItem = button.closest('.movie-item');
            const details = movieItem.querySelector('.movie-details');
            details.style.display = details.style.display === 'block' ? 'none' : 'block';
        }

        
        window.onload = popular; // Chama a função para exibir filmes populares ao carregar a página
    </script>
</body>
</html>
